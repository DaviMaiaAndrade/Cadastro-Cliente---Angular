<div fxLayout="row" fxLayoutAlign="center" class="page-container">
    <div fxLayout="column" fxFlex="1000px" class="content-wrapper">

        <!-- Formulário de Busca -->
        <form class="search-form" #buscaForm="ngForm" (ngSubmit)="pesquisar()">
            <mat-card class="search-card">
                <mat-card-header class="card-header">
                    <mat-icon class="header-icon">search</mat-icon>
                    <mat-card-title>Pesquisa de Clientes</mat-card-title>
                </mat-card-header>
                <mat-card-content class="card-content">
                    <div fxLayout="row">
                        <div fxLayout="column" fxFlex="100">
                            <mat-form-field class="full-width" appearance="outline">
                                <mat-label>Buscar por nome</mat-label>
                                <input name="nomeBusca"
                                       [(ngModel)]="nomeBusca"
                                       matInput
                                       placeholder="Digite o nome do cliente" />
                                <mat-icon matPrefix>person_search</mat-icon>
                            </mat-form-field>
                        </div>
                    </div>
                </mat-card-content>
                <mat-card-actions class="card-actions">
                    <button type="submit" mat-raised-button color="primary" class="search-button">
                        <mat-icon>search</mat-icon>
                        <span>Pesquisar</span>
                    </button>
                </mat-card-actions>
            </mat-card>
        </form>

        <!-- Tabela de Resultados -->
        <div class="results-container">
            <mat-card class="results-card">
                <mat-card-header class="card-header">
                    <mat-icon class="header-icon">list</mat-icon>
                    <mat-card-title>Resultados da Pesquisa</mat-card-title>
                    <span class="results-count">{{ listaClientes.length }} cliente(s) encontrado(s)</span>
                </mat-card-header>
                <mat-card-content class="table-content">

                    <div class="table-container">
                        <table mat-table [dataSource]="listaClientes" class="clientes-table">

                            <ng-container matColumnDef="id">
                                <th mat-header-cell *matHeaderCellDef>ID</th>
                                <td mat-cell *matCellDef="let cliente" class="id-cell">
                                    {{ cliente.id }}
                                </td>
                            </ng-container>

                            <ng-container matColumnDef="nome">
                                <th mat-header-cell *matHeaderCellDef>Nome</th>
                                <td mat-cell *matCellDef="let cliente" class="nome-cell">
                                    <div class="cell-content">
                                        <mat-icon class="cell-icon">person</mat-icon>
                                        {{ cliente.nome }}
                                    </div>
                                </td>
                            </ng-container>

                            <ng-container matColumnDef="cpf">
                                <th mat-header-cell *matHeaderCellDef>CPF</th>
                                <td mat-cell *matCellDef="let cliente">{{ cliente.cpf }}</td>
                            </ng-container>

                            <ng-container matColumnDef="dataNascimento">
                                <th mat-header-cell *matHeaderCellDef>Data de Nascimento</th>
                                <td mat-cell *matCellDef="let cliente">{{ cliente.dataNascimento }}</td>
                            </ng-container>

                            <ng-container matColumnDef="email">
                                <th mat-header-cell *matHeaderCellDef>Email</th>
                                <td mat-cell *matCellDef="let cliente" class="email-cell">
                                    <div class="cell-content">
                                        <mat-icon class="cell-icon">email</mat-icon>
                                        {{ cliente.email }}
                                    </div>
                                </td>
                            </ng-container>

                            <ng-container matColumnDef="acoes">
                                <th mat-header-cell *matHeaderCellDef class="acoes-header">Ações</th>
                                <td mat-cell *matCellDef="let cliente" class="acoes-cell">
                                    <button type="button"
                                            mat-raised-button
                                            color="primary"
                                            class="edit-button"
                                            (click)="preparaEditar(cliente.id)">
                                        <mat-icon>edit</mat-icon>
                                        <span>Editar</span>
                                    </button>

                                    @if(!cliente.deletando){
                                        <button type="button"
                                                mat-raised-button
                                                color="warn"
                                                class="delete-button"
                                                (click)="preparaDeletar(cliente)">
                                            <mat-icon>delete</mat-icon>
                                            <span>Deletar</span>
                                        </button>
                                    } @else {
                                        <button type="button"
                                                mat-raised-button
                                                color="accent"
                                                class="confirm-button"
                                                (click)="deletar(cliente)">
                                            <mat-icon>check_circle</mat-icon>
                                            <span>Confirmar</span>
                                        </button>
                                        <button type="button"
                                                mat-button
                                                class="cancel-button"
                                                (click)="cancelarDeletar(cliente)">
                                            <mat-icon>cancel</mat-icon>
                                            <span>Cancelar</span>
                                        </button>
                                    }
                                </td>
                            </ng-container>

                            <tr mat-header-row *matHeaderRowDef="colunasTable"></tr>
                            <tr mat-row *matRowDef="let row; columns: colunasTable" class="table-row"></tr>
                        </table>
                    </div>

                    <div *ngIf="listaClientes.length === 0" class="empty-state">
                        <mat-icon class="empty-icon">search_off</mat-icon>
                        <h3>Nenhum cliente encontrado</h3>
                        <p>Tente ajustar os filtros de busca</p>
                    </div>

                </mat-card-content>
            </mat-card>
        </div>
    </div>
</div>
